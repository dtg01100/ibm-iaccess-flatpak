app-id: com.ibm.iaccess
runtime: org.freedesktop.Platform//23.08
sdk: org.freedesktop.Sdk//23.08
extensions:
  - org.freedesktop.Sdk.Extension.openjdk
modules:
  - name: ibm-iaccess
    buildsystem: simple
    build-commands:
      - ls -l
      - install -D launch-ibmiaccess.sh /app/launch-ibmiaccess.sh
      - chmod -R u+rwX,go+rX .
      - mkdir -p /app/IBMiAccess_v1r1
      - cp -r * /app/IBMiAccess_v1r1/
      - install -D ibm-iaccess.desktop /app/share/applications/ibm-iaccess.desktop
      - install -D /app/IBMiAccess_v1r1/Icons/logo128.png /app/share/icons/hicolor/128x128/apps/ibm-iaccess.png
    sources:
      - type: dir
        path: IBMiAccess_v1r1
      - type: file
        path: launch-ibmiaccess.sh
      - type: file
        path: ibm-iaccess.desktop
      - type: file
        path: IBMiAccess_v1r1/Icons/logo128.png
finish-args:
  # Allow network access for remote connections
  - --share=network
  # Allow access to user's home directory (can be restricted further)
  - --filesystem=home
  # Allow access to host fonts for fontconfig
  - --filesystem=host:ro
  - --filesystem=/usr/share/fonts:ro
  # Allow access to host fontconfig settings
  - --filesystem=xdg-config/fontconfig:ro
  # Enable X11 and Wayland for GUI
  - --socket=x11
  - --socket=wayland
  # Add OpenJDK extension for Java runtime
  - --extension=org.freedesktop.Sdk.Extension.openjdk=system
  # Add other permissions as needed
  # Allow desktop notifications
  - --talk-name=org.freedesktop.Notifications
  # Enable desktop export
  - --metadata=X-Flatpak-Export-Desktop=true
command: "/app/launch-ibmiaccess.sh"
